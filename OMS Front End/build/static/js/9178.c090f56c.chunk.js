"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[9178],{67724:(e,t,s)=>{s.d(t,{A:()=>n});s(27565);var a=s(85097),i=s(27929);const n=e=>{let{isApprovalValidate:t,showModal:s,handleToggleModal:n,children:l,...o}=e;return(0,i.jsxs)(a.A,{className:`center-model-popup ${o.modelSizeClass}`,show:s,onHide:n,keyboard:!t,backdrop:!t||"static",children:[(0,i.jsx)(a.A.Header,{closeButton:!t,children:(0,i.jsx)("div",{className:"model-title",children:o.modalTitle})}),(0,i.jsx)(a.A.Body,{children:l})]})}},19178:(e,t,s)=>{s.r(t),s.d(t,{default:()=>y});var a=s(27565),i=s(17295),n=s(69885),l=s(11030),o=s(67724),c=s(15335),r=s(79663);const d={name:"Add Edit Role Form",initialState:{roleName:""},formFields:[{id:"roleName",lable:"Role Name ",Field_Name:"Role Name",fieldType:c.Q.INPUT,dataField:"roleName",fieldSetting:{placeholder:"Enter Role Name",allowSpace:!0},validation:[{type:"require"}],style:{containerCss:"col-xxl-12 col-xl-12 col-md-12 mb-input"}}],formSetting:{isViewOnly:!1}},u={columns:[{name:"Role Name",fieldName:"roleName",allowShort:!0,colStyle:{width:"80%"}},{name:"Action",colStyle:{width:"20%"},colType:r.f.ACTION,defaultAction:{allowEdit:!0,allowDelete:!0},customAction:[{name:"USER",title:"Assign User",iconName:"mi:user",className:"disable-icon"},{name:"PERMISSION",iconName:"ph:key",title:"Permission",className:"key-icon"}]}]};var m=s(18637),f=s(60497),g=s(50383),S=s(65748),A=s(19888),E=s(15269),h=s(27929);const N=e=>{const t=(0,a.useRef)(),[s,i]=(0,a.useState)(d),{formSetting:n}=d,[l,o]=(0,a.useState)(!1),c=(0,E.T)(A.o.ADDSECURITYROLE),r=(0,E.T)(A.o.EDITSECURITYROLE);(0,a.useEffect)((()=>{e.isEdit?!0===r.isViewOnly?(n.isViewOnly=!0,o(!0)):(n.isViewOnly=!1,o(!1)):e.isEdit||!0===c.hasAccess&&(n.isViewOnly=!1,o(!1))}),[e.isEdit,r,c,n.isViewOnly]);const[u,{isLoading:N,isSuccess:w,data:p}]=(0,g.RB)(),[x,{isLoading:T,isSuccess:C,data:b}]=(0,g.J_)();(0,a.useEffect)((()=>{j()}),[e.initData]);const j=()=>{let t={...s};t.initialState={...e.initData},i(t)};return(0,a.useEffect)((()=>{w&&p&&(e.onSuccess&&e.onSuccess(),S.A.success(p.errorMessage))}),[w,p]),(0,a.useEffect)((()=>{C&&b&&(e.onSuccess&&e.onSuccess(),S.A.success(b.errorMessage))}),[C,b]),(0,h.jsx)("div",{children:(0,h.jsxs)("div",{className:"row",children:[(0,h.jsx)("div",{className:"col-md-12 add-role-input",children:(0,h.jsx)("div",{className:"row vertical-form",children:(0,h.jsx)(m.A,{ref:t,config:s,...s})})}),(0,h.jsx)("div",{className:"col-md-12",children:(0,h.jsxs)("div",{className:"d-flex align-item-center justify-content-end mt-3",children:[(0,h.jsx)(f.A,{buttonTypeClassName:"theme-button",onClick:()=>{let s=t.current.getFormData();!e.isEdit&&s?u(s):e.isEdit&&s&&x(s)},buttonText:""+(e.isEdit?"Update":"Add"),isLoading:N||T,isDisable:l}),(0,h.jsx)(f.A,{buttonTypeClassName:"dark-btn ml-5",buttonText:"Cancel",onClick:e.onModalClose})]})})]})})},w={name:"Add Edit Role Form",initialState:{userName:""},formFields:[{id:"userId",lable:"Users",Field_Name:"Users",fieldType:c.Q.SELECT,dataField:"userName",fieldSetting:{placeholder:"Select Users",isEnableOnChange:!0},validation:[{type:"require"}],style:{containerCss:"col-xxl-10 col-xl-10 col-md-10"}}],formSetting:{isViewOnly:!1}},p={columns:[{name:"User Name",fieldName:"userName",colStyle:{width:"80%"},allowShort:!0},{name:"Action",colStyle:{width:"20%"},colType:r.f.ACTION,defaultAction:{allowEdit:!1,allowDelete:!0}}]};var x=s(50042),T=s(80889),C=s(62360);const b=e=>{const t=(0,a.useRef)(),s=(0,a.useRef)(),[n,l]=(0,a.useState)(0),[o,c]=(0,a.useState)(),[r]=(0,a.useState)(w),[d,u]=(0,a.useState)(!1),[g,N]=(0,a.useState)(!1),{formSetting:b}=w,j=p.columns.find((e=>"Action"===e.name)),D=(0,E.T)(A.o.ADDASSIGNUSERS),y=(0,E.T)(A.o.DELETEASSIGNUSERS);(0,a.useEffect)((()=>{!0===y.hasAccess?j.defaultAction.allowDelete=!0:!1===y.hasAccess&&(j.defaultAction.allowDelete=!1)}),[y,j.defaultAction.allowDelete]),(0,a.useEffect)((()=>{D.hasAccess?(b.isViewOnly=!1,u(!0)):u(!1)}),[D,b.isViewOnly]);const{confirm:I}=(0,T.A)(),[R,{isLoading:O,isSuccess:v,data:P}]=(0,x.CS)(),[U,{isFetching:L,isSuccess:M,data:k}]=(0,x.QY)(),[F,{isLoading:V,isSuccess:z,data:Y}]=(0,x.SN)(),[B,{isSuccess:G,data:Q}]=(0,x.l2)();(0,a.useEffect)((()=>{e.isOpen&&U(e.initData.roleId)}),[e.isOpen]),(0,a.useEffect)((()=>{if(!L&&M&&k){const e=k.map((e=>({value:e.userId,label:e.userName})));w.formFields.find((e=>"userName"===e.dataField)).fieldSetting.options=e,N((e=>!e))}}),[L,M,k]);const _=(t,s)=>{const a={pagination:{pageNumber:t.pageNumber,pageSize:t.pageSize},filters:{searchText:""},roleId:e.initData.roleId,sortString:s};F(a)};(0,a.useEffect)((()=>{z&&Y&&(Y&&c(Y.dataSource),Y.totalRecord&&l(Y.totalRecord))}),[z,Y]),(0,a.useEffect)((()=>{if(t.current){const e=t.current.getCurrentPageObject();_(e,t.current.generateSortingString())}}),[e.isOpen]);(0,a.useEffect)((()=>{if(v&&P){S.A.success(P.errorMessage);const s=t.current.getCurrentPageObject();_(s,t.current.generateSortingString()),U(e.initData.roleId)}}),[v,P]),(0,a.useEffect)((()=>{if(G&&Q){S.A.success(Q.errorMessage);const s=t.current.getCurrentPageObject();_(s,t.current.generateSortingString()),U(e.initData.roleId)}}),[G,Q]);const q={DELETE:e=>{I("Delete?","Are you sure you want to Delete?","Delete","Cancel").then((t=>{t&&B(e.userRoleId)}))}};return(0,h.jsx)("div",{children:(0,h.jsxs)("div",{className:"row",children:[(0,h.jsx)("div",{className:"col-12 assign-user-form",children:(0,h.jsxs)("div",{className:"row mt-2 assign-user-model-section",children:[(0,a.createElement)(m.A,{ref:s,config:r,...r,key:g}),(0,h.jsx)("div",{className:"col-xxl-2 col-xl-2 col-md-2 mt-4 right-btn",children:d?(0,h.jsx)(f.A,{buttonTypeClassName:"theme-button",buttonText:"Add",onClick:()=>{let t=s.current.getFormData();if(null!=t&&e.initData){let s={userId:t.userName.value,roleId:e.initData.roleId};R(s)}},isLoading:O}):null})]})}),(0,h.jsx)(i.default,{cardTitle:"Users",children:(0,h.jsx)("div",{className:"col-md-12 table-striped",children:(0,h.jsx)(C.A,{ref:t,configuration:p,dataSource:o,allowPagination:!0,pagination:{totalCount:n,pageSize:20,currentPage:1},onPageChange:e=>{_(e,t.current.generateSortingString())},onSorting:e=>{_(t.current.getCurrentPageObject(),e)},isLoading:V,onActionChange:q})})})]})})};var j=s(79742),D=s(74573);const y=()=>{const e=(0,a.useRef)(),[t,s]=(0,a.useState)(0),[c,r]=(0,a.useState)(),[m,f]=(0,a.useState)(!1),[w,p]=(0,a.useState)(!1),[x,y]=(0,a.useState)(!1),[I,R]=(0,a.useState)(d.initialState),O=(0,l.Zp)(),{confirm:v}=(0,T.A)(),[P,U]=(0,a.useState)(!1),{formSetting:L}=d,M=u.columns.find((e=>"Action"===e.name)),k=(0,E.T)(A.o.ASSIGNUSERS),F=(0,E.T)(A.o.ADDSECURITYROLE),V=(0,E.T)(A.o.EDITSECURITYROLE),z=(0,E.T)(A.o.DELETESECURITYROLE),Y=(0,E.T)(A.o.PERMISSIONMANAGEMENT);(0,a.useEffect)((()=>{!0===V.isViewOnly||!0===V.isEditable?M.defaultAction.allowEdit=!0:M.defaultAction.allowEdit=!1}),[V,M.defaultAction.allowEdit]),(0,a.useEffect)((()=>{!0===z.hasAccess?M.defaultAction.allowDelete=!0:!1===z.hasAccess&&(M.defaultAction.allowDelete=!1)}),[z,M.defaultAction.allowDelete]),(0,a.useEffect)((()=>{F.hasAccess?(L.isViewOnly=!1,U(!0)):U(!1)}),[V,F,L.isViewOnly]),(0,a.useEffect)((()=>{!0===Y.hasAccess?M.defaultAction.allowPermission=!0:!1===Y.hasAccess&&(M.defaultAction.allowPermission=!1)}),[Y,M.defaultAction.allowPermission]),(0,a.useEffect)((()=>{!0===k.hasAccess?M.defaultAction.allowUser=!0:!1===k.hasAccess&&(M.defaultAction.allowUser=!1)}),[k,M.defaultAction.allowUser]);const[B,{isLoading:G,isSuccess:Q,data:_}]=(0,g.aZ)(),[q,{isSuccess:H,data:Z}]=(0,g.xb)(),$=()=>{y(!1),J(),p(!w)},J=()=>{let e={...d.initialState};R(e)},W=(e,t)=>{const s={pagination:{pageNumber:e.pageNumber,pageSize:e.pageSize},filters:{searchText:""},sortString:t};B(s)};(0,a.useEffect)((()=>{Q&&_&&(_&&r(_.dataSource),_.totalRecord&&s(_.totalRecord))}),[Q,_]),(0,a.useEffect)((()=>{if(H&&Z){S.A.success(Z.errorMessage);const t=e.current.getCurrentPageObject();W(t,e.current.generateSortingString())}}),[H,Z]),(0,a.useEffect)((()=>{if(e.current){const t=e.current.getCurrentPageObject();W(t,e.current.generateSortingString())}}),[]);const K={EDIT:e=>{J(),R(e),y(!0),p(!w)},DELETE:e=>{v("Delete?","Are you sure you want to Delete?","Delete","Cancel").then((t=>{t&&q(e.roleId)}))},PERMISSION:e=>{O(`/EditPermissions/${(0,D.rS)(e.roleId)}`)},USER:e=>{f(!0),R(e)}},X=()=>{p(!w),J()};return(0,h.jsxs)("div",{className:"security-list",children:[(0,h.jsx)(i.default,{cardTitle:"Security Roles",buttonClassName:"btn theme-button",rightButton:P,buttonText:"Add",textWithIcon:!0,iconImg:n.m.PlusIcon,titleButtonClick:$,children:(0,h.jsx)("div",{className:"row",children:(0,h.jsx)("div",{className:"col-md-12 table-striped",children:(0,h.jsx)(C.A,{ref:e,configuration:u,dataSource:c,allowPagination:!1,pagination:{totalCount:t,pageSize:20,currentPage:1},onPageChange:t=>{W(t,e.current.generateSortingString())},onSorting:t=>{W(e.current.getCurrentPageObject(),t)},isLoading:G,onActionChange:K})})})}),(0,h.jsx)(o.A,{showModal:w,handleToggleModal:$,modalTitle:I.roleId?"Update Role":"Add Role",modelSizeClass:"w-40",children:(0,h.jsx)(N,{onModalClose:X,isEdit:x,initData:I,onSuccess:()=>{X();const t=e.current.getCurrentPageObject();W(t,e.current.generateSortingString())}})}),(0,h.jsx)(j.default,{modalTitle:"Assign Users",contentClass:"content-35",onClose:()=>{f(!1)},modalTitleIcon:n.m.AddIcon,isOpen:m,children:(0,h.jsx)(b,{initData:I,isOpen:m})})]})}}}]);
//# sourceMappingURL=9178.c090f56c.chunk.js.map