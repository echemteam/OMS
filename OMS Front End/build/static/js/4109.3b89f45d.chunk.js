"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[4109],{34109:(e,t,i)=>{i.r(t),i.d(t,{default:()=>g});var s=i(10723),n=i(27565),r=i(26533),c=i(19888),a=i(80889),u=i(17295),o=i(69885);const d=(e,t)=>{let i=[],s=e.filter((e=>e.securityKeyParentId===t));return s&&s.forEach((function(t){let s=d(e,t.securityKeyId),n={id:t.securityKeyId,name:t.securityKeyName,icon:o.m.folderIcon,itemData:{...t},isActive:!1,children:s};i.push(n)})),i},l=e=>{let t=[];return e&&e.forEach((function(e){let i=[];(null===e||void 0===e?void 0:e.children.length)>0&&(i=l(null===e||void 0===e?void 0:e.children),t=t.concat(i));let s={roleId:e.itemData.roleId,securityKeyId:e.itemData.securityKeyId,securitySettingId:e.itemData.securitySettingId,securityPermissionId:e.itemData.securityPermissionId};t.push(s)})),t};var m=i(15269),y=i(34281),f=i(95899),h=i(27929);const I=n.lazy((()=>i.e(3830).then(i.bind(i,43830)))),g=(0,n.forwardRef)(((e,t)=>{const i=(0,s.wA)(),{confirm:o}=(0,a.A)(),[g,S]=(0,n.useState)([]),[P,p]=(0,n.useState)(!0),[v,b]=(0,n.useState)([]),{togglePermissionCard:E,selectedRoleId:K,childRef:C}=(0,n.useContext)(y.k),[k,{isSuccess:w,data:x}]=(0,f.w1)(),[D,{isFetching:A,isSuccess:j,data:L}]=(0,f.B)(),N=(0,m.T)(c.o.SAVEPERMISSIONS),R=e=>{S(e)},B=e=>{D(e)};return(0,n.useImperativeHandle)(C,(()=>({callChildFunction:B}))),(0,n.useEffect)((()=>{K&&D(K)}),[K]),(0,n.useEffect)((()=>{if(j&&L){const e=(e=>d(e,0))(L);R(e),b(e)}}),[j,L]),(0,n.useEffect)((()=>{!0===N.hasAccess?p(!0):p(!1)}),[N]),(0,n.useEffect)((()=>{w&&x&&o("Security Permissions Updated!","You will be logged out! Please Log In again","Log Out","",!1).then((e=>{e&&i((0,r.ri)())}))}),[w,x]),(0,h.jsx)(n.Fragment,{children:E&&K&&(0,h.jsx)("div",{className:"permission-list",children:(0,h.jsx)(u.default,{cardTitle:"Security Permissions",rightButton:!!P,buttonText:"Save Permissions",buttonClassName:"btn theme-button",titleButtonClick:()=>{if(g&&g.length>0){let e=(e=>{let t=[];return t=l(e),t})(g);const t=e.map((e=>({securitySettingId:e.securitySettingId,securityKeyId:e.securityKeyId,roleId:e.roleId})));k({securityPermissionsList:t})}},children:(0,h.jsx)(I,{onPermissionSet:R,onUpdatePermission:e=>{b(e),R(e)},isLoading:A,permissionsData:v})})})})}))}}]);
//# sourceMappingURL=4109.3b89f45d.chunk.js.map