"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[6282],{66282:(e,t,s)=>{s.r(t),s.d(t,{default:()=>y});var c=s(27565),n=s(14490),i=s(38860),a=s(69377),l=s(15269),r=s(3737),d=s(80889),o=s(65748),u=s(28734),m=s(37204),p=s.n(m),h=s(35263),v=s(79742),x=s(76969),f=s(27929);const y=(0,c.forwardRef)((e=>{let{keyId:t,isSupplier:s,downloadDocument:m,deleteDocumentsById:y,getDocumentsById:A,childRef:j,SecurityKey:I,isEditablePage:D,isArchive:w}=e;const{confirm:N}=(0,d.A)(),[g,S]=(0,c.useState)([]),[E,C]=(0,c.useState)(!0),[P,T]=(0,c.useState)(!0),[b,k]=(0,c.useState)(null),[F,L]=(0,c.useState)([]),[R,Y]=(0,c.useState)(!1),[O,M]=(0,c.useState)(null),[U,B]=(0,c.useState)(),[V,{isSuccess:H,data:_}]=y(),[z,{isFetching:G,isSuccess:K,data:W}]=A(),[Z,{isFetching:q,isSuccess:J,data:Q}]=m();(0,c.useEffect)((()=>{ee()}),[t,w]),(0,c.useEffect)((()=>{if(D&&I){const e=(0,l.T)(I.DELETE),t=(0,l.T)(I.DOWNALOD);e&&(!0===e.hasAccess?C(!0):C(!1)),t&&(!0===t.hasAccess?T(!0):T(!1))}}),[D,I]),(0,c.useEffect)((()=>{if(K&&W&&!G){let e=s?(0,r.i_)(W):(0,r.EV)(W);Array.isArray(e)||(e=Object.values(e).flat());const t=e.filter((e=>e.isArchive===w));S(t);const c=new Set;t.forEach((e=>{const t=$(e.attachment);["pdf","csv","docx","xlsx"].includes(t)&&c.add(t)})),L(Array.from(c))}}),[K,W,G,w]),(0,c.useEffect)((()=>{if(!q&&J&&Q){const e=Q.fileData,t=new Blob([e],{type:e.type}),s=URL.createObjectURL(t);if("download"===O){const e=document.createElement("a");e.href=s,e.download=U,document.body.appendChild(e),e.click(),e.remove(),URL.revokeObjectURL(s)}else"view"===O&&(k(s),Y(!0),L($(Q.fileName)))}}),[q,J,Q]),(0,c.useEffect)((()=>{H&&_&&(o.A.success(_.errorMessage),ee())}),[H,_]);const X=(e,c,n)=>{B(n),k(null),Y(!1),M(e);let i={folderName:s?u.Dh.SUPPLIER:u.Dh.CUSTOMER,keyId:t,fileName:c};"download"!==e&&"view"!==e||Z(i)},$=e=>{switch(null===e||void 0===e?void 0:e.split(".").pop().toLowerCase()){case"pdf":return"pdf";case"docx":return"docx";case"ppt":case"pptx":return"pptx";case"xlsx":return"xlsx";case"csv":return"csv";case"xls":return"xls";case"doc":return"doc";default:return null}},ee=()=>{t&&z(t)};(0,c.useImperativeHandle)(j,(()=>({callChildFunction:ee})));return(0,f.jsxs)("div",{className:"document-list-sec",children:[(0,f.jsx)("div",{className:"document-listing",children:(0,f.jsx)("div",{className:"row",children:G?(0,f.jsx)(i.A,{}):g.length>0?g.map((e=>(0,f.jsx)("div",{className:"col-xl-4 col-lg-4 col-md-6 col-12",children:(0,f.jsxs)("div",{className:"documents",children:[(0,f.jsx)("div",{className:"left-icons",children:(0,f.jsx)(n.A,{imagePath:e.documentIcon,alt:"Document Icon"})}),(0,f.jsxs)("div",{className:"right-desc",children:[(0,f.jsxs)("div",{className:"doc-details",children:[(0,f.jsx)("div",{className:"document-typename",children:e.type}),(0,f.jsx)("div",{className:"document-name",children:e.name}),(0,f.jsx)("div",{className:"document-type",children:e.attachment}),(0,f.jsx)("div",{className:"document-type",children:(0,x.Ay)(e.createdAt,"MM/DD/YYYY hh:mm A")})]}),(0,f.jsxs)("div",{className:"document-action",children:[F.length>0&&["pdf","csv","docx","xlsx"].includes($(e.attachment))&&(0,f.jsx)("span",{className:"action-icon",onClick:()=>X("view",e.attachment),children:(0,f.jsx)(h.A,{icon:"lets-icons:view-light"})}),P&&(0,f.jsx)("span",{className:"action-icon",onClick:()=>X("download",e.attachment,e.name),children:(0,f.jsx)(h.A,{icon:"uil:folder-download"})}),w?null:E&&(0,f.jsx)("span",{className:"action-icon",onClick:()=>{return t=s?e.supplierDocumentId:e.customerDocumentId,void N("Delete?","Are you sure you want to Delete?","Delete","Cancel").then((e=>{e&&V(t)}));var t},children:(0,f.jsx)(h.A,{icon:"mingcute:delete-2-line",className:"delete-icon"})})]})]})]})},e.customerDocumentId))):(0,f.jsx)(a.A,{})})}),(0,f.jsx)(v.default,{isOpen:R,contentClass:"content-65",modalTitle:"File Preview",onClose:()=>{Y(!1),k(null),M(null)},children:(0,f.jsx)("div",{className:"model-height-fix doc-view",children:b&&F?"pdf"===F?(0,f.jsx)("div",{className:"pdf-iframe",children:(0,f.jsx)("iframe",{src:b,title:"PDF Preview",style:{width:"100%",height:"200%"}})}):(0,f.jsx)(p(),{fileType:F,filePath:b,onError:e=>console.error("Error:",e)}):null})})]})}))},3737:(e,t,s)=>{s.d(t,{Co:()=>o,EV:()=>p,H:()=>a,Ix:()=>r,Vz:()=>d,i_:()=>h,jZ:()=>l,oP:()=>u,xG:()=>i});var c=s(76969),n=s(91868);const i=e=>[{id:0,type:"All",isForSuppliers:!0,isForCustomers:!0,contactTypeId:""},...e],a=(e,t)=>t?String(e&&"object"===typeof e?e.value:e):Array.isArray(e)?e.map(String).join(","):String(e&&"object"===typeof e?e.value:e),l=e=>[{id:0,type:"All",isForSuppliers:!0,isForCustomers:!0,addressTypeId:""},...e],r=e=>{const t=e.every((e=>!e.isPrimary));return e.map(((e,s)=>({...e,extension:"-"===e.extension?0:e.extension,isPrimary:!(!t||0!==s)||e.isPrimary})))},d=e=>{const t=e.every((e=>!e.isPrimary));return e.map(((e,s)=>({...e,isPrimary:!(!t||0!==s)||e.isPrimary})))},o=e=>e.map((e=>({...e,description:e.description+" by "+e.name+" on "+(0,c.Ay)(e.changedAt,"MM/DD/YYYY hh:mm A")}))),u=e=>{const t=null===e||void 0===e?void 0:e.split("."),s=(null===t||void 0===t?void 0:t.length)>1?t[t.length-1]:"";return m(s)},m=e=>{const t=n.r.find((t=>t.type===e));return t?t.icon:null},p=e=>e.reduce(((e,t)=>{const{type:s,attachment:c,customerDocumentId:n,customerId:i,documentTypeId:a,name:l,createdAt:r,isArchive:d}=t,o={attachment:c,customerDocumentId:n,customerId:i,documentTypeId:a,name:l,documentIcon:u(c),createdAt:r,isArchive:d,type:s};return e[s]||(e[s]=[]),e[s].push(o),e}),{}),h=e=>e.reduce(((e,t)=>{const{type:s,attachment:c,supplierDocumentId:n,supplierId:i,documentTypeId:a,name:l,createdAt:r,isArchive:d}=t,o={attachment:c,supplierDocumentId:n,supplierId:i,documentTypeId:a,name:l,documentIcon:u(c),createdAt:r,isArchive:d};return e[s]||(e[s]=[]),e[s].push(o),e}),{})}}]);
//# sourceMappingURL=6282.400d48b7.chunk.js.map